{% extends "base.html" %}

{% block lab %}Лабораторная работа 5{% endblock %}

{% block main %}

<h1>Статьи</h1>

{% if articles|length == 0 %}
    <div>Статей пока нет.</div>
{% else %}
    {% for article in articles %}
        <div style="border-bottom: 1px solid black; margin-bottom: 15px; padding-bottom: 10px;">
            <h2>{{ article['title'] }}</h2>
            <blockquote style="white-space: pre-line;">{{ article['article_text'] }}</blockquote>

            {% if article.get('is_favorite', False) %}
                <p style="color: red; font-weight: bold;">Любимая статья</p>
            {% endif %}

            {% if login and article['user_id'] == user_id %}
                <a href="{{ url_for('lab5.edit_article', article_id=article['id']) }}">Редактировать</a>
                <form action="{{ url_for('lab5.delete_article', article_id=article['id']) }}" method="post" style="display:inline;">
                    <button type="submit" onclick="return confirm('Удалить статью?')">Удалить</button>
                </form>
            {% endif %}

            {% if login %}
                <form action="{{ url_for('lab5.toggle_favorite', article_id=article['id']) }}" method="post" style="display:inline;">
                    <button type="submit">
                        {% if article.get('is_favorite', False) %}
                            Убрать из избранного
                        {% else %}
                            Добавить в избранное
                        {% endif %}
                    </button>
                </form>
            {% else %}
                <p><a href="{{ url_for('lab5.login') }}">Войдите</a>, чтобы добавить в избранное</p>
            {% endif %}

        </div>
    {% endfor %}
{% endif %}

{% endblock %}
